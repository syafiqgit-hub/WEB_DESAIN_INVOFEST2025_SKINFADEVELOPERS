<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Cerdas Finansial</title>
    <link rel="shortcut icon" type="image/x-icon" href="../assets/media/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
         :root {
            --primary-color: #f35b04;
            --secondary-color: #ed8a07;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --text-muted: #666666;
            --border-color: #e9ecef;
            --shadow: rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #ffffff;
            --text-muted: #cccccc;
            --border-color: #404040;
            --shadow: rgba(0, 0, 0, 0.3);
        }
        
        [data-theme="dark"] body,
        [data-theme="dark"] body h1,
        [data-theme="dark"] body h2,
        [data-theme="dark"] body h3,
        [data-theme="dark"] body h4,
        [data-theme="dark"] body h5,
        [data-theme="dark"] body h6,
        [data-theme="dark"] body p,
        [data-theme="dark"] body a,
        [data-theme="dark"] body span,
        [data-theme="dark"] body label,
        [data-theme="dark"] .card,
        [data-theme="dark"] .card-header,
        [data-theme="dark"] .container,
        [data-theme="dark"] .sidebar,
        [data-theme="dark"] .sidebar .sidebar-header,
        [data-theme="dark"] .sidebar .sidebar-nav a,
        [data-theme="dark"] .stat-card,
        [data-theme="dark"] .notification,
        [data-theme="dark"] .progress-item,
        [data-theme="dark"] .btn-custom,
        [data-theme="dark"] .form-control,
        [data-theme="dark"] label {
            color: var(--text-color) !important;
        }
        
        [data-theme="dark"] .form-control,
        [data-theme="dark"] input,
        [data-theme="dark"] textarea,
        [data-theme="dark"] select {
            background-color: var(--card-bg) !important;
            color: var(--text-color) !important;
            border-color: var(--border-color) !important;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: var(--transition);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            transform: translateX(-100%);
            transition: var(--transition);
            z-index: 1000;
            box-shadow: 2px 0 10px var(--shadow);
        }
        
        .sidebar.show {
            transform: translateX(0);
        }
        
        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .sidebar-header h3 {
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .sidebar .sidebar-header .header-logo {
            max-width: 160px;
            width: 100%;
            height: auto;
            display: block;
            margin: 0 auto 10px;
            object-fit: contain;
        }
        
        @media (max-width: 768px) {
            .sidebar .sidebar-header .header-logo {
                max-width: 220px;
            }
        }
        
        .sidebar-nav {
            list-style: none;
            padding: 0;
        }
        
        .sidebar-nav li {
            margin-bottom: 10px;
        }
        
        .sidebar-nav a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px 15px;
            border-radius: 5px;
            transition: var(--transition);
        }
        
        .sidebar-nav a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 10px var(--shadow);
            transition: var(--transition);
        }
        
        .sidebar-toggle:hover {
            transform: scale(1.1);
        }
        
        .main-content {
            margin-left: 0;
            transition: var(--transition);
        }
        
        .main-content.shifted {
            margin-left: 250px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 50px 30px;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 40px;
            box-shadow: 0 5px 20px var(--shadow);
            animation: fadeInUp 0.8s ease-out;
            transition: all 0.3s ease;
        }
        /* Teks di hero */
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 30px;
            text-align: left;
        }
        /* RESPONSIVE STYLING */
        
        @media (max-width: 1024px) {
            .hero {
                padding: 40px 25px;
            }
            .hero h1 {
                font-size: 2rem;
            }
            .hero p {
                font-size: 1.1rem;
                text-align: center;
            }
        }
        
        @media (max-width: 768px) {
            .hero {
                padding: 35px 20px;
            }
            .hero h1 {
                font-size: 1.8rem;
                line-height: 1.3;
            }
            .hero p {
                font-size: 1rem;
                text-align: center;
            }
        }
        
        @media (max-width: 480px) {
            .hero {
                padding: 30px 15px;
                border-radius: 10px;
            }
            .hero h1 {
                font-size: 1.5rem;
            }
            .hero p {
                font-size: 0.95rem;
                text-align: center;
            }
        }
        
        .progress-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .progress-item {
            flex: 1;
            min-width: 200px;
        }
        
        .progress {
            height: 10px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-bar {
            background: white;
            transition: width 0.5s ease;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
            margin-bottom: 30px;
            background-color: var(--card-bg);
            transition: var(--transition);
            animation: fadeInUp 0.8s ease-out;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px var(--shadow);
        }
        
        .card-header {
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
            padding: 20px 25px;
            border-radius: 15px 15px 0 0 !important;
            font-size: 1.1rem;
        }
        
        .stat-card {
            text-align: center;
            padding: 25px;
            height: 100%;
        }
        
        .stat-card .card-body {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-top: 10px;
        }
        
        .btn-custom {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 500;
            transition: var(--transition);
        }
        
        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 91, 4, 0.3);
            color: white;
        }
        
        .chart-container {
            height: 300px;
            margin: 25px 0;
        }
        
        #chart {
            margin-top: 24px;
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group .form-control {
            border-radius: 8px 0 0 8px;
            border: 1px solid var(--border-color);
            padding: 10px 15px;
            transition: var(--transition);
        }
        
        .input-group .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(243, 91, 4, 0.25);
        }
        
        .input-group .btn-custom {
            border-radius: 0 8px 8px 0;
        }
        
        .notification {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: var(--transition);
        }
        
        .notification:hover {
            box-shadow: 0 2px 10px var(--shadow);
        }
        
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 10px var(--shadow);
            transition: var(--transition);
        }
        
        .dark-mode-toggle:hover {
            transform: scale(1.1);
        }
        
        .notification-toggle {
            position: fixed;
            top: 20px;
            right: 80px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 10px var(--shadow);
            transition: var(--transition);
        }
        
        .notification-toggle:hover {
            transform: scale(1.1);
        }
        
        .notification-toggle i,
        .dark-mode-toggle i {
            color: var(--text-color);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .notification-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 350px;
            max-height: 400px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
            z-index: 1002;
            display: none;
            overflow-y: auto;
            animation: slideDown 0.3s ease-out;
        }
        
        .notification-panel.show {
            display: block;
        }
        
        .notification-panel-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
            font-size: 1rem;
        }
        
        .notification-panel-body {
            padding: 0;
        }
        
        .notification-panel .notification {
            margin: 0;
            border: none;
            border-bottom: 1px solid var(--border-color);
            border-radius: 0;
            padding: 15px 20px;
            cursor: pointer;
        }
        
        .notification-panel .notification:last-child {
            border-bottom: none;
        }
        
        .notification-panel .notification:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        [data-theme="dark"] .notification-panel .notification:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-size: 0.95rem;
            margin-top: 50px;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                transform: translateX(-100%);
            }
            .main-content.shifted {
                margin-left: 0;
            }
            .hero h1 {
                font-size: 2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .progress-section {
                flex-direction: column;
                align-items: stretch;
            }
            .stat-card .card-body {
                flex-direction: row;
                text-align: left;
            }
            .stat-value {
                margin-top: 0;
                margin-left: 15px;
            }
            .chart-container {
                height: 250px;
            }
            .hero {
                margin-top: 30px;
            }
        }
        
        .android-desktop .hero h1 {
            font-size: 2.5rem !important;
        }
        
        .android-desktop .hero p {
            font-size: 1.2rem !important;
        }
        
        .android-desktop .progress-section {
            flex-direction: row !important;
            align-items: center;
        }
        
        .android-desktop .progress-item {
            flex: 1;
            min-width: 200px;
        }
        
        @media (min-width: 769px) {
            .sidebar-toggle {
                display: none;
            }
            .sidebar {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 250px;
            }
        }
        
        @media (min-width: 992px) {
            .sidebar-toggle {
                display: none;
            }
        }
        
        #greeting {
            text-align: left;
        }
        
        .goal-row {
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .goal-actions button {
            margin-left: 8px;
        }
        
        #tips {
            margin: 20px auto;
            border-radius: 12px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            transition: 0.3s ease;
        }
        
        #tips .card-header {
            font-weight: 600;
            font-size: 1.1rem;
            background: #f35b04;
            color: white;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }
        
        #tips .card-body {
            padding: 15px 20px;
        }
        
        #tips .btn-custom {
            color: white;
            border: none;
        }
        
        @media (max-width: 768px) {
            #tips .card-body {
                flex-direction: column;
                align-items: stretch;
                text-align: left;
            }
            #tips .tip-buttons {
                margin-top: 12px;
                text-align: left;
            }
            #tips .tip-buttons button {
                width: 48%;
                font-size: 0.9rem;
            }
            #tips .tip-buttons #next-tip {
                margin-left: 4%;
            }
        }
        
        @media (max-width: 480px) {
            #tips .card-header {
                font-size: 1rem;
            }
            #tips .tip-buttons button {
                width: 100%;
                margin-bottom: 8px;
            }
            #tips .tip-buttons #next-tip {
                margin-left: 0;
            }
        }
        
        #goals {
            max-width: 100%;
            margin: 0 auto;
        }
        
        #goals .card-header {
            font-size: 1rem;
        }
        
        #goals .card-body {
            padding: 1rem;
        }
        
        #goals .row.g-2 .col-md-4,
        #goals .row.g-2 .col-md-3,
        #goals .row.g-2 .col-md-2 {
            flex: 1 1 auto;
            min-width: 100px;
        }
        
        @media (max-width: 768px) {
            #goals .row.g-2 .col-md-4,
            #goals .row.g-2 .col-md-3,
            #goals .row.g-2 .col-md-2 {
                flex: 0 0 100%;
            }
            #goals .mb-3 h6 {
                font-size: 0.9rem;
            }
            #goals .mt-2.text-end {
                text-align: center !important;
            }
            #goals .btn-custom {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            #goals {
                padding: 0.5rem;
            }
            #goals .card-body {
                padding: 0.5rem;
            }
        }
    </style>
</head>

<body>
    <button class="sidebar-toggle" id="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <button class="notification-toggle" id="notification-toggle">
        <i class="fas fa-bell"></i>
        <span class="notification-badge" id="notification-badge">2</span>
    </button>

    <div class="notification-panel" id="notification-panel">
        <div class="notification-panel-header">
            <i class="fas fa-bell"></i> Notifikasi
        </div>
        <div class="notification-panel-body">
        </div>
    </div>

    <button class="dark-mode-toggle" id="dark-mode-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header" style="text-align: left;">
            <a href="#hero"></a><img src="../assets/media/logo-dashboard.png" alt="Cerdas Finansial company logo with vibrant orange and blue colors" class="header-logo">
        </div>
        <ul class="sidebar-nav">
            <li><a href="#hero"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="analisis-keuangan.html"><i class="fas fa-chart-pie"></i> Analisis Keuangan</a></li>

        </ul>
    </div>

    <div class="main-content" id="main-content">
        <div class="container my-4">
            <div class="hero" id="hero">
                <h1 id="greeting">Selamat Datang di Dashboard Finansial!</h1>
                <p style="text-align: left;">Kelola keuanganmu dengan cerdas hari ini ðŸ’°</p>
            </div>

            <div class="card" id="financial-data">
                <div class="card-header">Data Finansial Anda</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <label>Saldo Dompet</label>
                            <div class="input-group">
                                <input type="text" id="wallet-input" class="form-control" placeholder="Rp 0">
                                <button class="btn btn-custom" onclick="updateData('wallet')">Update</button>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label>Tabungan Saat Ini</label>
                            <div class="input-group">
                                <input type="text" id="savings-input" class="form-control" placeholder="Rp 0">
                                <button class="btn btn-custom" onclick="updateData('savings')">Update</button>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label>Pengeluaran Bulanan</label>
                            <div class="input-group">
                                <input type="text" id="expenses-input" class="form-control" placeholder="Rp 0">
                                <button class="btn btn-custom" onclick="updateData('expenses')">Update</button>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label>Target Keuangan (Default)</label>
                            <div class="input-group">
                                <input type="text" id="target-input" class="form-control" placeholder="Rp 0">
                                <button class="btn btn-custom" onclick="updateData('target')">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" id="stats">
                <div class="col-md-3">
                    <div class="card stat-card">
                        <div class="card-body d-flex align-items-center">
                            <i class="fas fa-wallet fa-2x text-primary me-3"></i>
                            <div>
                                <h5>Dompet</h5>
                                <div class="stat-value" id="wallet">Rp 0</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card">
                        <div class="card-body d-flex align-items-center">
                            <i class="fas fa-piggy-bank fa-2x text-success me-3"></i>
                            <div>
                                <h5>Tabungan</h5>
                                <div class="stat-value" id="savings">Rp 0</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card">
                        <div class="card-body d-flex align-items-center">
                            <i class="fas fa-credit-card fa-2x text-danger me-3"></i>
                            <div>
                                <h5>Pengeluaran</h5>
                                <div class="stat-value" id="expenses">Rp 0</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card">
                        <div class="card-body d-flex align-items-center">
                            <i class="fas fa-bullseye fa-2x text-warning me-3"></i>
                            <div>
                                <h5>Target</h5>
                                <div class="stat-value" id="target">Rp 0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" id="chart">
                <div class="card-header"><i class="fas fa-chart-bar"></i> Grafik Pengeluaran vs Pemasukan</div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="financeChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card" id="tips">
                <div class="card-header"><i class="fas fa-lightbulb"></i> Tips Finansial Hari Ini</div>
                <div class="card-body d-flex align-items-start justify-content-between">
                    <div style="flex:1;">
                        <p id="daily-tip" style="font-weight:500; font-size:1rem; margin-bottom:8px;">Memuat tips...</p>
                        <small id="daily-tip-source" class="text-muted"></small>
                    </div>
                    <div class="text-end" style="min-width:160px;">
                        <button class="btn btn-outline-secondary btn-sm" id="prev-tip"><i class="fas fa-chevron-left"></i></button>
                        <button class="btn btn-custom btn-sm" id="next-tip" style="margin-left:8px;">Tips Berikutnya</button>
                    </div>
                </div>
            </div>


            <div class="card" id="goals">
                <div class="card-header d-flex align-items-center justify-content-between">
                    <div><i class="fas fa-bullseye"></i> Target Keuangan Pribadi</div>
                    <div>
                        <button class="btn btn-outline-secondary btn-sm" id="refresh-goals"><i class="fas fa-sync"></i></button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="goals-list">
                    </div>

                    <hr>

                    <div class="mb-3">
                        <h6>Tambah Target Baru</h6>
                        <div class="row g-2">
                            <div class="col-md-4">
                                <input type="text" id="new-goal-title" class="form-control" placeholder="Judul (mis. Liburan Bali)">
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="new-goal-target" class="form-control" placeholder="Target (Rp)">
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="new-goal-saved" class="form-control" placeholder="Tersimpan (Rp)">
                            </div>
                            <div class="col-md-2">
                                <input type="date" id="new-goal-deadline" class="form-control">
                            </div>
                        </div>
                        <div class="mt-2 text-end">
                            <button class="btn btn-custom" id="add-goal">Tambah Target</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="text-center">
            <a href="#" id="logoutBtn">
        Logout
    </a>
        </div>

        <style>
            #logoutBtn {
                background-color: #e74c3c !important;
                color: white !important;
                padding: 0.5rem 1rem;
                border-radius: 0.25rem;
                text-decoration: none;
                display: inline-block;
                transition: background-color 0.3s ease;
            }
            
            #logoutBtn:hover {
                background-color: #c0392b !important;
            }
            
            .mobile-bottom-nav {
                position: fixed;
                bottom: 15px;
                left: 50%;
                transform: translateX(-50%);
                width: 92%;
                max-width: 450px;
                background: #ffffff;
                border-radius: 30px;
                box-shadow: 0 4px 25px rgba(0, 0, 0, 0.15);
                display: none;
                justify-content: space-around;
                align-items: center;
                padding: 10px 0;
                z-index: 99;
                border: 1px solid #ddd;
            }
            
            .mobile-bottom-nav a {
                color: black;
                text-align: center;
                flex: 1;
                text-decoration: none;
                font-size: 12px;
                transition: all 0.3s ease;
            }
            
            .mobile-bottom-nav a i {
                font-size: 20px;
                display: block;
                margin-bottom: 4px;
            }
            
            .mobile-bottom-nav a.active {
                color: #f35b04;
            }
            
            .mobile-bottom-nav a:hover {
                color: #f35b04;
            }
            
            @media (max-width: 768px) {
                .mobile-bottom-nav {
                    display: flex;
                }
                .sembunyi {
                    display: none;
                }
            }
        </style>

        <div class="mobile-bottom-nav">
            <a href="../index.html" data-name="home"> <i class="fa-solid fa-house"></i> <span>Home</span> </a>
            <a href="../fitur-detail-1.html" data-name="fitur">
                <i class="fa-solid fa-puzzle-piece"></i>
                <span>Fitur</span>
            </a>
            <a href="#" id="dashboard-link" data-name="dashboard" class="active">
                <i class="fa-solid fa-chart-line"></i>
                <span>Dashboard</span>
            </a>
            <a href="../login.html" data-name="akun"> <i class="fa-solid fa-user"></i> <span>Akun</span> </a>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const logoutBtn = document.getElementById("logoutBtn");

                if (localStorage.getItem("isLoggedIn") !== "true") {
                    window.location.href = "../login.html";
                    return;
                }

                logoutBtn.addEventListener("click", function(e) {
                    e.preventDefault();
                    localStorage.removeItem("isLoggedIn");
                    localStorage.removeItem("loggedInUser");
                    alert("Kamu telah logout!");
                    window.location.href = "../index.html";
                });
            });
        </script>

        <footer>
            Â© 2025 All Rights Reserved Cerdas Finansial. Dibuat Oleh Skinfa Developers
        </footer>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            'use strict';

            (function() {
                const LS_KEY = 'cf_dashboard_data_v1';

                const DEFAULT_DATA = {
                    wallet: 0,
                    savings: 0,
                    expenses: 0,
                    target: 0,
                    learning: {
                        progress: 0,
                        lastTopic: {
                            title: 'Dasar Pengelolaan Keuangan',
                            desc: 'Pelajari cara mengatur budget harian dan bulanan'
                        }
                    },
                    notifications: [{
                        id: 1,
                        title: 'Kuis Keuangan Mingguan dimulai hari Jumat ini!',
                        time: '2 hari lalu',
                        read: false,
                        icon: 'fa-bell text-warning'
                    }, {
                        id: 2,
                        title: 'Ada topik baru: Dasar Investasi untuk Pemula ðŸ’¡',
                        time: '1 minggu lalu',
                        read: false,
                        icon: 'fa-star text-success'
                    }],
                    goals: [{
                        id: 1,
                        title: 'Liburan Tahunan',
                        targetAmount: 8000000,
                        saved: 6000000,
                        deadline: new Date(new Date().getFullYear(), new Date().getMonth() + 3, 1).toISOString().substr(0, 10),
                        notes: 'Sisihkan Rp 500k/bulan'
                    }, {
                        id: 2,
                        title: 'Dana Darurat',
                        targetAmount: 12000000,
                        saved: 7200000,
                        deadline: new Date(new Date().getFullYear(), new Date().getMonth() + 12, 1).toISOString().substr(0, 10),
                        notes: 'Target 6 bulan biaya hidup'
                    }, {
                        id: 3,
                        title: 'Investasi Jangka Panjang',
                        targetAmount: 50000000,
                        saved: 22500000,
                        deadline: new Date(new Date().getFullYear() + 3, 0, 1).toISOString().substr(0, 10),
                        notes: 'Reksa dana bulanan'
                    }],
                    tips: {
                        index: null
                    },
                    theme: 'light'
                };

                const TIPS = [{
                    text: 'Catat semua pengeluaranmu setiap hari biar bisa evaluasi keuangan mingguan!',
                    source: 'Dasar Pengelolaan'
                }, {
                    text: 'Sisihkan minimal 10% pemasukan ke tabungan darurat setiap bulan.',
                    source: 'Praktik Menabung'
                }, {
                    text: 'Gunakan metode amplop (envelope) untuk mengatur pengeluaran non-penting.',
                    source: 'Manajemen Anggaran'
                }, {
                    text: 'Cek langganan berulang Anda; hentikan yang tidak terpakai untuk hemat bulanan.',
                    source: 'Optimalisasi Pengeluaran'
                }, {
                    text: 'Mulai investasi kecil secara rutin (mis. Rp50k/minggu) untuk disiplin.',
                    source: 'Investasi Awal'
                }, {
                    text: 'Bayar utang berbunga tinggi terlebih dahulu untuk menurunkan beban bunga.',
                    source: 'Strategi Utang'
                }, {
                    text: 'Tentukan tujuan keuangan yang spesifik: nominal dan tanggal waktu.',
                    source: 'Perencanaan'
                }];

                function loadData() {
                    try {
                        const raw = localStorage.getItem(LS_KEY);
                        if (!raw) return structuredClone(DEFAULT_DATA);
                        const parsed = JSON.parse(raw);
                        const merged = Object.assign(structuredClone(DEFAULT_DATA), parsed);
                        if (!merged.tips) merged.tips = {
                            index: null
                        };
                        return merged;
                    } catch (e) {
                        console.error('Gagal membaca localStorage, gunakan default.', e);
                        return structuredClone(DEFAULT_DATA);
                    }
                }

                function saveData(data) {
                    try {
                        localStorage.setItem(LS_KEY, JSON.stringify(data));
                    } catch (e) {
                        console.error('Gagal menyimpan data ke localStorage', e);
                    }
                }

                const currencyFormatter = new Intl.NumberFormat('id-ID', {
                    style: 'currency',
                    currency: 'IDR',
                    maximumFractionDigits: 0
                });

                function formatCurrency(value) {
                    const num = Number(value) || 0;
                    return currencyFormatter.format(Math.round(num));
                }

                function parseCurrencyInput(str) {
                    if (typeof str !== 'string') return 0;
                    // Hapus semua karakter bukan digit atau minus
                    const cleaned = str.replace(/[^0-9\-]/g, '');
                    if (cleaned === '' || cleaned === '-') return 0;
                    const parsed = Number(cleaned);
                    return Number.isFinite(parsed) ? parsed : 0;
                }

                const el = {
                    sidebar: document.getElementById('sidebar'),
                    sidebarToggle: document.getElementById('sidebar-toggle'),
                    mainContent: document.getElementById('main-content'),
                    darkToggle: document.getElementById('dark-mode-toggle'),
                    notificationToggle: document.getElementById('notification-toggle'),
                    notificationBadge: document.getElementById('notification-badge'),
                    notificationPanel: document.getElementById('notification-panel'),
                    walletInput: document.getElementById('wallet-input'),
                    savingsInput: document.getElementById('savings-input'),
                    expensesInput: document.getElementById('expenses-input'),
                    targetInput: document.getElementById('target-input'),
                    walletStat: document.getElementById('wallet'),
                    savingsStat: document.getElementById('savings'),
                    expensesStat: document.getElementById('expenses'),
                    targetStat: document.getElementById('target'),
                    dailyTip: document.getElementById('daily-tip'),
                    dailyTipSource: document.getElementById('daily-tip-source'),
                    prevTipBtn: document.getElementById('prev-tip'),
                    nextTipBtn: document.getElementById('next-tip'),
                    lastTopicTitle: document.getElementById('last-topic-title'),
                    lastTopicDesc: document.getElementById('last-topic-desc'),
                    progressBar: document.getElementById('progress-bar'),
                    progressText: document.getElementById('progress-text'),
                    continueLearning: document.getElementById('continue-learning'),
                    greeting: document.getElementById('greeting'),
                    financeChartCanvas: document.getElementById('financeChart'),
                    goalsList: document.getElementById('goals-list'),
                    addGoalBtn: document.getElementById('add-goal'),
                    newGoalTitle: document.getElementById('new-goal-title'),
                    newGoalTarget: document.getElementById('new-goal-target'),
                    newGoalSaved: document.getElementById('new-goal-saved'),
                    newGoalDeadline: document.getElementById('new-goal-deadline'),
                    refreshGoalsBtn: document.getElementById('refresh-goals')
                };

                let data = loadData();
                let financeChart = null;
                let tipAutoRotateInterval = null;

                function escapeHtml(unsafe) {
                    if (typeof unsafe !== 'string') return '';
                    return unsafe
                        .replaceAll('&', '&amp;')
                        .replaceAll('<', '&lt;')
                        .replaceAll('>', '&gt;')
                        .replaceAll('"', '&quot;')
                        .replaceAll("'", '&#039;');
                }

                function renderStats() {
                    el.walletStat.textContent = formatCurrency(data.wallet);
                    el.savingsStat.textContent = formatCurrency(data.savings);
                    el.expensesStat.textContent = formatCurrency(data.expenses);
                    el.targetStat.textContent = formatCurrency(data.target);

                    if (document.activeElement !== el.walletInput) el.walletInput.value = formatCurrency(data.wallet);
                    if (document.activeElement !== el.savingsInput) el.savingsInput.value = formatCurrency(data.savings);
                    if (document.activeElement !== el.expensesInput) el.expensesInput.value = formatCurrency(data.expenses);
                    if (document.activeElement !== el.targetInput) el.targetInput.value = formatCurrency(data.target);
                }

                function renderLearning() {
                    const prog = Math.max(0, Math.min(100, Math.round(data.learning.progress || 0)));
                    if (el.progressBar) {
                        el.progressBar.style.width = prog + '%';
                    }
                    if (el.progressText) el.progressText.textContent = prog + '% selesai';
                    if (el.lastTopicTitle) el.lastTopicTitle.textContent = data.learning.lastTopic.title;
                    if (el.lastTopicDesc) el.lastTopicDesc.textContent = data.learning.lastTopic.desc;
                }

                function renderNotifications() {
                    const panelBody = el.notificationPanel.querySelector('.notification-panel-body');
                    panelBody.innerHTML = '';
                    data.notifications.forEach(n => {
                        const div = document.createElement('div');
                        div.className = 'notification';
                        div.dataset.id = n.id;
                        div.innerHTML = `<i class="fas ${escapeHtml(n.icon)} me-2"></i> ${escapeHtml(n.title)}
        <small class="text-muted d-block">${escapeHtml(n.time)}</small>`;
                        if (!n.read) div.style.background = '';
                        div.addEventListener('click', () => {
                            markNotificationRead(n.id);
                        });
                        panelBody.appendChild(div);
                    });

                    const unreadCount = data.notifications.filter(x => !x.read).length;
                    if (el.notificationBadge) {
                        if (unreadCount > 0) {
                            el.notificationBadge.style.display = 'flex';
                            el.notificationBadge.textContent = unreadCount;
                        } else {
                            el.notificationBadge.style.display = 'none';
                        }
                    }
                }

                function renderTheme() {
                    if (data.theme === 'dark') {
                        document.documentElement.setAttribute('data-theme', 'dark');
                        el.darkToggle.querySelector('i').className = 'fas fa-sun';
                    } else {
                        document.documentElement.removeAttribute('data-theme');
                        el.darkToggle.querySelector('i').className = 'fas fa-moon';
                    }
                }

                function renderGreeting() {
                    try {
                        const now = new Date();
                        const hour = now.getHours();
                        let greet = 'Selamat Datang di Dashboard Finansial!';
                        if (hour < 12) greet = 'Selamat Pagi, semangat menabung!';
                        else if (hour < 15) greet = 'Selamat Siang, cek keuanganmu hari ini!';
                        else if (hour < 18) greet = 'Selamat Sore, jangan lupa evaluasi pengeluaran!';
                        else greet = 'Selamat Malam, rencanakan keuangan esok hari!';
                        if (el.greeting) el.greeting.textContent = greet;
                    } catch (e) { /* ignore */ }
                }

                function ensureTipIndexInitialized() {
                    if (data.tips && Number.isInteger(data.tips.index)) return;
                    const now = new Date();
                    const start = new Date(now.getFullYear(), 0, 0);
                    const diff = now - start;
                    const oneDay = 1000 * 60 * 60 * 24;
                    const dayOfYear = Math.floor(diff / oneDay);
                    data.tips = data.tips || {};
                    data.tips.index = dayOfYear % TIPS.length;
                    saveData(data);
                }

                function showTipAtIndex(i) {
                    const idx = ((i % TIPS.length) + TIPS.length) % TIPS.length;
                    data.tips.index = idx;
                    saveData(data);
                    const tip = TIPS[idx];
                    if (el.dailyTip) el.dailyTip.textContent = tip.text;
                    if (el.dailyTipSource) el.dailyTipSource.textContent = 'Sumber: ' + tip.source;
                }

                function nextTip() {
                    ensureTipIndexInitialized();
                    showTipAtIndex((data.tips.index || 0) + 1);
                }

                function prevTip() {
                    ensureTipIndexInitialized();
                    showTipAtIndex((data.tips.index || 0) - 1);
                }

                function startTipAutoRotate() {
                    if (tipAutoRotateInterval) clearInterval(tipAutoRotateInterval);
                    tipAutoRotateInterval = setInterval(() => {
                        const prevIdx = data.tips.index;
                        const now = new Date();
                        const start = new Date(now.getFullYear(), 0, 0);
                        const diff = now - start;
                        const oneDay = 1000 * 60 * 60 * 24;
                        const dayOfYear = Math.floor(diff / oneDay);
                        const newIdx = dayOfYear % TIPS.length;
                        if (newIdx !== prevIdx) {
                            data.tips.index = newIdx;
                            saveData(data);
                            showTipAtIndex(newIdx);
                        }
                    }, 1000 * 60 * 60);
                }

                function createOrUpdateChart() {
                    const ctx = el.financeChartCanvas.getContext('2d');
                    const values = [
                        Number(data.wallet) || 0,
                        Number(data.savings) || 0,
                        Number(data.expenses) || 0,
                        Number(data.target) || 0
                    ];
                    const labels = ['Dompet', 'Tabungan', 'Pengeluaran', 'Target'];

                    if (!financeChart) {
                        financeChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels,
                                datasets: [{
                                    label: 'Jumlah (Rp)',
                                    data: values,
                                    backgroundColor: ['#f35b04', '#28a745', '#dc3545', '#ffc107'],
                                    borderRadius: 6
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                const val = (context.parsed && context.parsed.y !== undefined) ? context.parsed.y : (context.raw || 0);
                                                return formatCurrency(val);
                                            }
                                        }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: {
                                            callback: function(val) {
                                                return formatCurrency(val);
                                            }
                                        }
                                    }
                                }
                            }
                        });
                    } else {
                        financeChart.data.datasets[0].data = values;
                        financeChart.update();
                    }
                }

                function computeProgress(goal) {
                    const saved = Number(goal.saved) || 0;
                    const target = Number(goal.targetAmount) || 0;
                    if (target <= 0) return 0;
                    return Math.min(100, Math.round((saved / target) * 100));
                }

                function renderGoals() {
                    if (!el.goalsList) return;
                    el.goalsList.innerHTML = '';
                    if (!Array.isArray(data.goals)) data.goals = [];
                    data.goals.forEach(goal => {
                        const percent = computeProgress(goal);
                        const remaining = Math.max(0, (Number(goal.targetAmount) || 0) - (Number(goal.saved) || 0));
                        const deadlineText = goal.deadline ? (' tanggal: ' + goal.deadline) : '';
                        const div = document.createElement('div');
                        div.className = 'goal-row';
                        div.innerHTML = `
                            <div class="d-flex align-items-start justify-content-between">
                                <div style="flex:1">
                                    <strong>${escapeHtml(goal.title)}</strong>
                                    <div class="text-muted" style="font-size:0.9rem">${escapeHtml(goal.notes || '')}${deadlineText}</div>
                                    <div class="mt-2">
                                        <small>Target: ${formatCurrency(goal.targetAmount)} â€¢ Tersimpan: ${formatCurrency(goal.saved)} â€¢ Sisa: ${formatCurrency(remaining)}</small>
                                    </div>
                                </div>
                                <div style="width:220px; margin-left:16px; text-align:right;">
                                    <div class="mb-2"><strong>${percent}%</strong></div>
                                    <div class="progress" style="height:10px;">
                                        <div class="progress-bar bg-primary" role="progressbar" style="width:${percent}%"></div>
                                    </div>
                                    <div class="mt-2 goal-actions">
                                        <button class="btn btn-outline-secondary btn-sm" data-action="edit" data-id="${goal.id}"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-outline-danger btn-sm" data-action="delete" data-id="${goal.id}"><i class="fas fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>
                        `;
                        el.goalsList.appendChild(div);
                    });

                    el.goalsList.querySelectorAll('[data-action]').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            const action = btn.getAttribute('data-action');
                            const id = Number(btn.getAttribute('data-id'));
                            if (action === 'edit') editGoal(id);
                            else if (action === 'delete') deleteGoal(id);
                        });
                    });
                }

                function addGoalFromForm() {
                    const title = (el.newGoalTitle.value || '').trim();
                    const targetAmount = parseCurrencyInput(el.newGoalTarget.value || '');
                    const saved = parseCurrencyInput(el.newGoalSaved.value || '');
                    const deadline = el.newGoalDeadline.value || '';
                    if (!title) {
                        alert('Masukkan judul target.');
                        return;
                    }
                    const newId = data.goals.reduce((m, g) => Math.max(m, g.id || 0), 0) + 1;
                    const goal = {
                        id: newId,
                        title,
                        targetAmount: Math.max(0, Math.round(targetAmount)),
                        saved: Math.max(0, Math.round(saved)),
                        deadline,
                        notes: ''
                    };
                    data.goals.push(goal);
                    saveData(data);
                    renderGoals();
                    el.newGoalTitle.value = '';
                    el.newGoalTarget.value = '';
                    el.newGoalSaved.value = '';
                    el.newGoalDeadline.value = '';
                    createOrUpdateChart();
                }

                function editGoal(id) {
                    const goal = data.goals.find(g => g.id === id);
                    if (!goal) return alert('Target tidak ditemukan.');
                    const newTitle = prompt('Judul target:', goal.title);
                    if (newTitle === null) return;
                    const newTargetRaw = prompt('Target jumlah (angka, tanpa simbol):', String(goal.targetAmount || '0'));
                    if (newTargetRaw === null) return;
                    const newSavedRaw = prompt('Tersimpan saat ini (angka):', String(goal.saved || '0'));
                    if (newSavedRaw === null) return;
                    const newDeadline = prompt('Tanggal tanggal (YYYY-MM-DD):', goal.deadline || '');
                    if (newDeadline === null) return;

                    goal.title = (newTitle || '').trim() || goal.title;
                    goal.targetAmount = Math.max(0, parseCurrencyInput(String(newTargetRaw)));
                    goal.saved = Math.max(0, parseCurrencyInput(String(newSavedRaw)));
                    goal.deadline = newDeadline || goal.deadline;
                    saveData(data);
                    renderGoals();
                    createOrUpdateChart();
                }

                function deleteGoal(id) {
                    if (!confirm('Hapus target ini?')) return;
                    data.goals = data.goals.filter(g => g.id !== id);
                    saveData(data);
                    renderGoals();
                    createOrUpdateChart();
                }


                window.updateData = function updateData(field) {
                    try {
                        let inputEl;
                        switch (field) {
                            case 'wallet':
                                inputEl = el.walletInput;
                                break;
                            case 'savings':
                                inputEl = el.savingsInput;
                                break;
                            case 'expenses':
                                inputEl = el.expensesInput;
                                break;
                            case 'target':
                                inputEl = el.targetInput;
                                break;
                            default:
                                console.warn('Field tidak dikenali', field);
                                return;
                        }
                        const raw = inputEl.value || '';
                        const num = parseCurrencyInput(raw);
                        if (!Number.isFinite(num)) {
                            alert('Nilai tidak valid. Masukkan angka yang benar.');
                            return;
                        }
                        data[field] = Math.max(0, Math.round(num));
                        saveData(data);
                        renderAll();
                        const statEl = document.getElementById(field);
                        if (statEl) {
                            statEl.style.transition = 'transform 0.15s ease';
                            statEl.style.transform = 'scale(1.03)';
                            setTimeout(() => {
                                statEl.style.transform = '';
                            }, 200);
                        }
                    } catch (e) {
                        console.error('Gagal updateData', e);
                    }
                };

                function markNotificationRead(id) {
                    const idx = data.notifications.findIndex(n => n.id === id);
                    if (idx === -1) return;
                    data.notifications[idx].read = true;
                    saveData(data);
                    renderNotifications();
                }

                function clearAllNotifications() {
                    data.notifications.forEach(n => n.read = true);
                    saveData(data);
                    renderNotifications();
                }

                function attachListeners() {
                    if (el.sidebarToggle && el.sidebar) {
                        el.sidebarToggle.addEventListener('click', () => {
                            el.sidebar.classList.toggle('show');
                            el.mainContent.classList.toggle('shifted');
                        });
                    }

                    if (el.darkToggle) {
                        el.darkToggle.addEventListener('click', () => {
                            data.theme = (data.theme === 'dark') ? 'light' : 'dark';
                            saveData(data);
                            renderTheme();
                        });
                    }

                    if (el.notificationToggle && el.notificationPanel) {
                        el.notificationToggle.addEventListener('click', (e) => {
                            e.stopPropagation();
                            el.notificationPanel.classList.toggle('show');
                        });
                        document.addEventListener('click', (ev) => {
                            if (!el.notificationPanel.contains(ev.target) && !el.notificationToggle.contains(ev.target)) {
                                el.notificationPanel.classList.remove('show');
                            }
                        });
                    }

                    [
                        ['walletInput', el.walletInput],
                        ['savingsInput', el.savingsInput],
                        ['expensesInput', el.expensesInput],
                        ['targetInput', el.targetInput],
                        ['newGoalTarget', el.newGoalTarget],
                        ['newGoalSaved', el.newGoalSaved]
                    ].forEach(([name, input]) => {
                        if (!input) return;
                        input.addEventListener('blur', () => {
                            const num = parseCurrencyInput(input.value);
                            input.value = num === 0 ? '' : formatCurrency(num);
                        });
                        input.addEventListener('focus', () => {
                            const num = parseCurrencyInput(input.value);
                            input.value = num === 0 ? '' : String(num);
                        });
                    });

                    if (el.continueLearning) {
                        el.continueLearning.addEventListener('click', () => {
                            data.learning.progress = Math.min(100, data.learning.progress + 10);
                            data.learning.lastTopic = data.learning.lastTopic || {
                                title: 'Topik Baru',
                                desc: ''
                            };
                            saveData(data);
                            renderLearning();
                            createOrUpdateChart();
                        });
                    }

                    if (el.nextTipBtn) el.nextTipBtn.addEventListener('click', () => nextTip());
                    if (el.prevTipBtn) el.prevTipBtn.addEventListener('click', () => prevTip());

                    if (el.addGoalBtn) el.addGoalBtn.addEventListener('click', () => addGoalFromForm());

                    if (el.refreshGoalsBtn) el.refreshGoalsBtn.addEventListener('click', () => renderGoals());

                    document.addEventListener('keydown', (ev) => {
                        if (ev.key === 'c' && (ev.ctrlKey || ev.metaKey)) {
                            ev.preventDefault();
                            clearAllNotifications();
                        }
                    });
                }

                function renderAll() {
                    renderGreeting();
                    renderStats();
                    renderLearning();
                    renderNotifications();
                    renderTheme();
                    createOrUpdateChart();
                    renderGoals();
                    ensureTipIndexInitialized();
                    showTipAtIndex(data.tips.index || 0);

                    if (el.dailyTip) {
                        if ((Number(data.expenses) || 0) > (Number(data.savings || 0) + Number(data.wallet || 0)) * 0.6) {
                            console.debug('Pengeluaran tinggi dibanding aset â€” sarankan evaluasi.');
                        }
                    }
                }

                function init() {
                    renderAll();
                    attachListeners();
                    renderNotifications();
                    startTipAutoRotate();
                }

                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', init);
                } else {
                    init();
                }

                window.cfDashboard = {
                    getData: () => structuredClone(data),
                    save: () => {
                        saveData(data);
                    },
                    resetToDefault: () => {
                        data = structuredClone(DEFAULT_DATA);
                        saveData(data);
                        renderAll();
                    },
                    formatCurrency,
                    parseCurrencyInput,
                    nextTip,
                    prevTip
                };

            })();
        </script>

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const isLoggedIn = localStorage.getItem("isLoggedIn");
                if (isLoggedIn !== "true") {
                    window.location.href = "../login.html";
                }
            });
        </script>

</body>

</html>